Вариант 7. Имитация отжига для TSP


Код реализует метаэвристику — имитацию отжига для решения задачи коммивояжёра (TSP) с ручным вводом матрицы расстояний для 8 городов. Вот как работает этот алгоритм по шагам:

1. Ввод данных:
   - Пользователь вручную вводит матрицу расстояний размером 8x8, где каждый элемент описывает расстояние между двумя городами.

2. Инициализация:
   - Алгоритм создаёт случайный начальный маршрут — последовательность обхода всех городов без повторов.
   - Вычисляется длина этого начального маршрута.

3. Основной цикл имитации отжига:
   - Изначально температура установлена на 100.
   - Пока температура не снизится до очень малого значения (0.01), повторяются циклы с заданным количеством итераций (1000):
     - На каждой итерации создаётся новое соседнее решение маршрута путём 2-opt обмена (выбирается случайный промежуток городов, который разворачивается).
     - Вычисляется длина нового маршрута.
     - Рассчитывается разница по длине (дельта) между новым и текущим маршрутом.
     - Если новый маршрут короче, он принимается гарантированно.
     - Если новый маршрут длиннее, он принимается с вероятностью $$ e^{-\Delta/T} $$, где $$ \Delta $$ — ухудшение, $$ T $$ — текущая температура.
     - Такой подход (критерий Метрополиса) позволяет алгоритму избежать застревания в локальных оптимумах.
     - Если найден улучшенный маршрут (меньшая длина), он запоминается как лучший.

4. Охлаждение температуры:
   - После каждой группы итераций температура уменьшается на коэффициент 0.95, снижая вероятность принятия худших решений.

5. Аналитика:
   - Ведётся учёт числа улучшений маршрута при каждой температуре для оценки эффективности поиска.

6. Итог:
   - После завершения цикла выводится лучший найденный маршрут, его стоимость, и статистика улучшений по температурам.

Таким образом, код последовательно исследует пространство маршрутов, начиная с случайного обхода, постепенно "затвердевая" (охлаждаясь) и сужая область поиска к оптимальному или хорошему решению. 2-opt обмены обеспечивают эффективное исследование соседних решений. Параметры (начальная температура, коэффициент охлаждения, число итераций) регулируют баланс между глобальным поиском и локальной оптимизацией.

Общая временная сложность кода имитации отжига для задачи коммивояжёра примерно равна $$O(N^2 \times I)$$, где:
- $$N$$ — число городов (в данном случае 8),
- $$I$$ — общее количество итераций (число температурных шагов умноженное на итерации на каждой температуре).

Объяснение сложности:

1. На каждой итерации алгоритма создаётся соседнее решение с помощью 2-opt обмена. 2-opt обмен — операция, которая за $$O(1)$$ времени меняет порядок маршрута (переворачивание подотрезка списка).

2. Однако для оценки стоимости нового маршрута функция пересчитывает длину всего маршрута, что требует обхода всех городов, то есть $$O(N)$$.

3. Перебор по шагам температуры и итерациям внутри каждого шага даёт примерно $$I$$ запусков.

4. Кроме того, в данном коде выбор индексов для 2-opt занимает $$O(1)$$, но пересчёт стоимости маршрута — ключевая операция, влияющая на время.

В сумме общая сложность порядка $$O(N \times I)$$. Поскольку $$I$$ задаётся как число температурных шагов $$\times$$ итераций на каждом шаге, и при $$N=8$$ значение $$N^2$$ можно считать условно, иногда приводят сложность как $$O(N^2 \times I)$$ исходя из того, что 2-opt иногда трактуется как $$O(N^2)$$ при тщательном переборе пар.


КОНТРОЛЬНЫЙ ВОПРОС №7. Коэффициент аппроксимации для составления расписания.


Коэффициент аппроксимации жадного алгоритма (List Scheduling) для задачи составления расписания на $$m$$ параллельных машинах доказывается равным $$2 - \frac{1}{m}$$.

### Идея доказательства
Пусть $$L^*$$ — оптимальное время завершения (makespan) и $$L$$ — время завершения, полученное жадным алгоритмом. Жадный алгоритм назначает каждую работу на машину с наименьшей текущей нагрузкой.

1. Рассмотрим машину с максимальной нагрузкой в финальном расписании, пусть эта нагрузка равна $$L$$.
2. Пусть последняя назначенная на эту машину работа имеет длину $$t_j$$.
3. Перед назначением этой работы на эту машину, нагрузка машины была $$L - t_j$$.
4. Поскольку работа шла на машину с минимальной нагрузкой, то на всех других $$m-1$$ машинах нагрузка была не меньше $$L - t_j$$.
5. Следовательно,
   $$
   (m-1)(L - t_j) \leq \sum_{k=1}^{m} L_k - t_j \leq \sum_{j=1}^{n} t_j - t_j,
   $$
   где $$L_k$$ — нагрузка машины $$k$$.

6. Из этого следует, что 
   $$
   L \leq \frac{1}{m} \sum_{j=1}^{n} t_j + (1 - \frac{1}{m}) t_j.
   $$

7. Оптимальное время завершения $$L^*$$ не меньше максимального времени работы одной задачи и не меньше среднего времени на одну машину:
   $$
   L^* \geq \max_j t_j, \quad L^* \geq \frac{\sum_{j=1}^n t_j}{m}.
   $$

8. Подставляя в неравенство для $$L$$, получаем:
   $$
   L \leq L^* + (1 - \frac{1}{m}) L^* = \left(2 - \frac{1}{m}\right) L^*.
   $$

### Итог
Таким образом, жадный алгоритм гарантирует расписание с временем завершения, не более чем в $$2 - \frac{1}{m}$$ раз превышающим оптимальное. Это и есть коэффициент аппроксимации алгоритма.

Этот результат впервые доказан в классической работе Graham (1966) по оценке жадных алгоритмов для параллельного составления расписаний и часто цитируется как базовая теорема в теории аппроксимационных алгоритмов для задач расписания.[1][2][3]

[1](https://fanchung.ucsd.edu/teach/202/14/11approx-alg0.pdf)
[2](https://algo.cs.uni-frankfurt.de/lehre/apx/winter2122/notes/notes.pdf)
[3](https://rasmuspagh.net/courses/sad12/11approx-alg.pdf)
[4](https://arxiv.org/pdf/2508.04159.pdf)
[5](https://www.mathnet.ru/php/getFT.phtml?jrnid=rm&paperid=10245&what=fullt&option_lang=rus)
[6](https://d-nb.info/102000150X/34)
[7](https://web.math.princeton.edu/~nalon/PDFS/aawy2.pdf)
[8](https://drops.dagstuhl.de/storage/00lipics/lipics-vol327-stacs2025/LIPIcs.STACS.2025.31/LIPIcs.STACS.2025.31.pdf)
[9](https://perso.ens-lyon.fr/frederic.vivien/EPIT/Slides/Schwiegelshohn.pdf)



